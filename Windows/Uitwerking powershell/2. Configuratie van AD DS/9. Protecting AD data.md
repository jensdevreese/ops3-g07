##Hoofdstuk 9: Protecting AD data


###Commando's die in dit hoofdstuk aan bod zullen komen:

| Commando                    | Betekenis                                                                                                   |
|-----------------------------|-------------------------------------------------------------------------------------------------------------|
| ADSnapshot                  | Maakt een snapshot van de active directory. Dit is een soort copy die dan kan gebruikt worden voor recovery. |
| Enable-ADOptionalFeature    | Zet een optionele feature aan. ZOals de Recycle Bin Feature om de kopie terug te zetten van een snapshot.   |
| WBPolicy                    | Voegt een policy toe aan de windows backup(New-). Of haalt ze op. (Get-)                                    |
| WBVolume                    | Wordt voorafgegaan door Get-, Set-, Add-. Om een windows backup volume aan te maken of op te vragen.        |
| Set-WBDisk                  | Stelt de windows backup in op een harde schijf.                                                             |
| WBFileSpec                  | Wordt voorafgegaan door New-. om en file path toe te voegen.                                                |
| WBBackup                    | Wordt voorafgegaan door Start-. Dit om de backup te starten.                                                |
| Start-WBSystemStateRecovery | Start de recovery van het systeem naar een vorige staat van de machine.                                     |

####Inleiding

Iedereen heeft het ooit wel al eens gehad bij het werken met een computer in het algemeen. Al de documenten waarmee men werkt staan op één pc tesamen. Als dan het noodlot toeslaat en er is een probleem met uw harde schijf ben je al je werk kwijt. Of anders, bij een schoonmaak van je documenten verwijder je toch wel net een document dat je eigenlijk toch nodig hebt..

Enorm frustrerend en net daarom is het dus belangrijk jouw documenten goed te beschermen. Dit kan door 4 technieken die we hier zullen bespreken.
* Bescherming tegen verwijdering
* Snapshots
* AD prullenbak
* Back-up

###Bescherming tegen verwijdering

Om dit in te stellen is vooral de eigenschap 'ProtectedFromAccidentalDeletion' belangrijk. 

Bijvoorbeeld bij het beschermen van een groep OU's of Users kan je dit dan instellen met de volgende scripts.

```PowerShell
#Dit script zal eerst zoeken naar de OU en dan na de pipeline zal het de eigenschap waar het om gaat op true zetten.
PS C:\>Get-ADObject -Identity "OU=teKiezenOU, DC=domein, DC=be" `
-Properties ProtectedFromAccidentalDeletion | Set-ADObject -ProtectedFromAccidentalDeletion:$true

#Hetzelfde als vorig script maar deze keer met gebruikers
PS C:\>Get-ADUser -SearchBase "OU=teKiezenOU, DC=domein, DC=be" -Filter * -Properties ProtectedFromAccidentalDeletion |`
Set-ADObject -ProtectedFromAccidentalDeletion:$true
```

Als je in de toekomst een van je users toch zou willen verwijderen zal je eerst de eigenschap weer op false moeten zetten voor je 'Remove-ADUser' zal kunnen gebruiken.

###Snapshots

###AD prullenbak

###Back-up & Restore

####Windows Backup installeren.

```PowerShell
PS C:\>Install-WindowsFeature -Name Windows-Server-Backup -IncludeAllSubFeature |`
Update-Help -Module WindowsServerBackup -Force
```

####Een WBVolume object toevoegen.

```PowerShell
$wbVol = Get-WBVolume -VolumePath C:
Add-WBVolume -Policy $newWBPol -Volume $wbVol
```

####Een WBFileSpec toevoegen.

```PowerShell
$incFSpec = New-WBFileSpec -FileSpec "D:\","C:\Temp"
$excFSpec = New-WBFileSpec -FileSpec "D:\PSHelp" -Exclude

Add-WBFileSpec -Policy $newWBPol -FileSpec $incFSpec
Add-WBFileSpec -Policy $newWBPol -FileSpec $excFSpec
```


####Uur aanpassen wanneer de backup altijd plaats vindt

```PowerShell
Set-WBSchedule -Policy $newWBPol -Schedule 12:00,20:00
```